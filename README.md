# CEVAE_project

Content description-
 
.
 model/                  Contains implementations of various VAE architectures <br>
 model/hvae_mu.py        Contains implementation of Hierarchical VAE architecture. <br>
 model/vqvae.py          Contain implementation of VQ-VAE architecture. <br>
 a1.py                   Script for running different model configurations and hyperparameters <br>
 parallel_script.py      Runs multiple scripts concurrently <br>
 results_syn.py          Reproduces Figure 3 from the research paper <br>
 results_beta.py         Reproduces Figure 3 with different beta values for the beta-VAE model <br>
 result_beta_t1.py       Reproduces Table 1 & Table 2 for beta-VAE model configurations <br>


 
## Steps for replicating results-

For tuning hyperparameter of different models over ihdp dataset, run hyperparameter_tune.py script. Results for each model configuration are stored in output_ht.txt file generated by the code.

To generate Table 2,3,4 and 5 values models (except beta-VAE and HVAE) run results_t1.py script. All the results will be stored in results_scores.txt file generated.

To generate Table 2,3,4 and 5 values for beta-VAE architecture with different beta values, run result_beta_t1.py script. A new text file results_scores_beta_t1.txt will be generated and stored in current directory having all the results.

To generate Figure 2 results for all the models, run results_syn.py file. Results will be scored in results_score_syn.txt file generated by code.
To generate Figure 2 for beta-VAE, run result_beta.py file, all the results will be stored in results_scores_beta.txt file generated through python script.
After that run figure_2_rep.ipynb to generate final image, where Test ATE results obtained from different models are stored in seperate list. 

To implement and replicate results for HVAE model all files are present in folder HVAE folder. Navigate to that folder and run following commands for getting results-

To replicate results for Table 2-5, navigate to HVAE folder run following commands-

python main.py --model hvae --ofile hvae_twin.txt --dataset twins --epochs 100 --replication 5

python main.py --model hvae --ofile hvae_jobs.txt --dataset jobs --epochs 100 --replication 5

python main.py --model hvae --ofile hvae_synthetic.txt --dataset synthetic --epochs 100 --replication 5

python main.py --model hvae --ofile hvae_ihdp.txt --dataset ihdp --epochs 100 --replication 5

To replicate results for Figure 2, run following commands-

python main.py --model hvae --ofile hvae_syn_1.txt --dataset synthetic --epochs 100 --replication 5 --nsample 1000

python main.py --model hvae --ofile hvae_syn_3.txt --dataset synthetic --epochs 100 --replication 5 --nsample 3000

python main.py --model hvae --ofile hvae_syn_5.txt --dataset synthetic --epochs 100 --replication 5 --nsample 5000

python main.py --model hvae --ofile hvae_syn_10.txt --dataset synthetic --epochs 100 --replication 5 --nsample 10000

